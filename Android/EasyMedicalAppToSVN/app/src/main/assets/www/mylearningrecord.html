<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<title>学习记录</title>
<link rel="stylesheet" type="text/css" href="css/reset.css"/>
<link rel="stylesheet" type="text/css" href="css/common2.css"/>
<link rel="stylesheet" type="text/css" href="css/mine.css"/>
</head>

<body>
<!--顶部开始-->
<div class="top">
    <div class="back" style="top:1%;left:0;width:10%;height:100%;background-image: url(img/back.png);background-size: 41% 61%;background-repeat: no-repeat;background-position:center;"></div>
    <div class="message"><a href="###" onclick="saveUrl()"></a></div>
    <h1>学习记录</h1>
</div>
<!--顶部结束-->

<!--收藏开始-->
<div id="bgwin"></div>
<div class="course_box">
<input type="hidden" id="courseid"/>
    <div class="menu">
        <div class="tab_ul clearfix">
            <div class="fleft selected" id="kcall">
                <a class="select_span">全部课程</a>
            </div>
            <div class="fleft" id="lastNew">
                <a class="select_span">最新</a>
            </div>
            <div class="fleft" id="btnsearch">
                <a>搜索</a>
            </div>
        </div>
        <div class="large_fixed">
            <ul class="none" id="kcall_list">
                <li data-id="1" class="selected"><a href="javascript:void(0)">切片</a></li>
                <li data-id="2"><a href="javascript:void(0)">题库</a></li>
                <li data-id="3"><a href="javascript:void(0)">试卷</a></li>
                <li data-id="4"><a href="javascript:void(0)">课程</a></li>
                <li data-id="5"><a href="javascript:void(0)">课件</a></li>
                <li data-id="6"><a href="javascript:void(0)">章节视频</a></li>
            </ul>
            <div class="search_fixed none" id="btnsearchBox">
                <div id="kcSearch">
                    <div class="search clearfix">
                        <form id="formSearch" action="" method="post" class="clearfix">
                            <input type="text" value="" id="input_search" placeholder="课程关键字"/>
                            <a href="javascript:void(0)" id="btns_search" class="btns_search"></a>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="history_list" id="leaningrecordlist">
        <ul>
         <li v-for="Curriculum in CurriculumList" class="clearfix">
            <div class="li_img_box">
            <img src="http://115.29.97.231:3000/{{Curriculum.ThumbnailUrl}}" v-if='{{Curriculum.ThumbnailUrl}} != null'/>
            <img src="img/li-img.png" v-else/>
            </div>
            <div class="li_content_box">
                <h1>{{Curriculum.CourseName}}</h1>
                <h3>讲师：{{Curriculum.Teacher}}</h3>
                <h3>课件数量：{{Curriculum.CourseWaresCount}} 总积分：{{Curriculum.TotalScore}}</h3>
                <h3 class="color1">{{Curriculum.CourseName}}</h3>
                <span>{{Curriculum.QuestionNum}}</span>
            </div>
            </li>
            <li v-for="CourseWare in CourseWareList" class="clearfix">
            <div class="li_img_box">
            <img src="http://115.29.97.231:3000/{{Curriculum.ThumbnailUrl}}" v-if='{{CourseWare.ThumbnailUrl}} != null'/>
            <img src="img/li-img.png" v-else/>
            </div>
            <div class="li_content_box">
                <h1>{{CourseWare.Name}}</h1>
                <h3>讲师：{{CourseWare.Teacher}}</h3>
                <h3>课件数量：{{CourseWare.totalPage}} 总积分：{{CourseWare.TotalScore}}</h3>
                <h3 class="color1">{{CourseWare.courseName}}</h3>
                <span>{{CourseWare.QuestionNum}}</span>
            </div>
            </li>

            <li v-for="Question in QuestionList" class="clearfix">
            <div class="li_img_box"><img src="img/li-img.png"/></div>
            <div class="li_content_box">
                <h1>{{Question.Content}}</h1>
                <h3></h3>
                <h3>总积分：{{Question.Score}}</h3>
                <h3 class="color1"></h3>
                <span>{{Question.CourseName}}</span>
            </div>
            </li>

            <li v-for="Exercise in ExerciseList" class="clearfix">
            <div class="li_img_box"><img src="img/li-img.png"/></div>
            <div class="li_content_box">
                <h1>{{Exercise.Content}}</h1>
                <h3>讲师：{{Exercise.Teacher}}</h3>
                <h3>总积分：{{Exercise.Score}}</h3>
                <h3 class="color1"></h3>
                <span>{{Question.CourseName}}</span>
            </div>
            </li>

            <li v-for="Slice in SliceList" class="clearfix">
            <div class="li_img_box">
            <img src="http://115.29.97.231:3000/{{Slice.ThumbnailUrl}}" v-if='{{Slice.ThumbnailUrl}} != null'/>
            <img src="img/li-img.png" v-else/>
            </div>
            <div class="li_content_box">
                <h1>{{Slice.Name}}</h1>
                <h3></h3>
                <h3></h3>
                <h3 class="color1"></h3>
                <span></span>
            </div>
            </li>

            <li v-for="Video in VideoList" class="clearfix">
            <div class="li_img_box">
            <img src="http://115.29.97.231:3000/{{Video.ThumbnailUrl}}" v-if='{{Video.ThumbnailUrl}} != null'/>
            <img src="img/li-img.png" v-else/>
            </div>
            <div class="li_content_box">
                <h1>{{Video.Name}}</h1>
                <h3></h3>
                <h3></h3>
                <h3 class="color1"></h3>
                <span></span>
            </div>
            </li>
        </ul>
    </div>
</div>
<!--收藏结束-->


    <script type="text/javascript" src="js/zepto/zepto.min.js"></script>
    <script type="text/javascript" src="js/zepto/divselect.js"></script>
    <script src="js/common/common.js" type="text/javascript" charset="utf-8" ></script>
    <script src="js/vue.js" type="text/javascript" charset="utf-8" ></script>
<script>
$(function(){   

     var recordList = new Vue({
        el: '#leaningrecordlist',
        data: {
            CurriculumList:[],
            CourseWareList:[],
            QuestionList:[],
            ExerciseList:[],
            SliceList:[],
            VideoList:[]
        },
    })
    getrecordlist();

    $(".tab_ul .fleft").click(function(){
        $(this).addClass("selected").siblings().removeClass("selected");
        if($(this).attr('id') == 'kcall'){
            $("#notread_list,#btnsearchBox").hide();
            $("#notread").removeClass("selectafter selectbefore");
            if($("#kcall_list").is(":hidden")){
                $("#kcall_list,#bgwin").show();
                $("#bgwin").css({'opacity':'0.5'});
            }else {
                $("#kcall_list,#bgwin").hide();
            }
            var codetxt = $(this).find('.select_span');
            $("#kcall_list li").click(function(e){
                $(this).addClass("selected").siblings().removeClass("selected");
                codetxt.text($(this).text());
                $("#kcall_list,#bgwin").hide();

                $("#courseid").val($(this).attr("data-id"));
                 /*var getText = $(this).text();
                    if(getText == "切片"){
                         textid = "SliceList=" + 1;
                    }else if(getText == "题库"){
                         textid = "QuestionList=" + 2;
                    }else if(getText == "试卷"){
                         textid = "ExamQuestionList=" + 3;
                    }else if(getText == "课程"){
                         textid = "CurriculumList=" + 4;
                    }else if(getText == "课件"){
                         textid = "CourseWareList=" + 5;
                    }else if(getText == "章节视频"){
                         textid = "VideoList=" + 6;
                    }*/
                    e.stopPropagation();

                    getrecordlist();
            });
        } else if($(this).attr('id') == 'lastNew'){
            $("#kcall_list,#btnsearchBox,#bgwin").hide();
        } else if($(this).attr('id') == 'btnsearch'){
            $("#kcall_list,#notread_list,#bgwin").hide();
            $("#notread").removeClass("selectafter selectbefore");
            if($("#btnsearchBox").is(":hidden")){
                $("#btnsearchBox,#bgwin").show();
                $("#bgwin").css({'opacity':'0.5'});
            }else {
                $("#btnsearchBox,#bgwin").hide();
            }
        } else {
            $("#notread_list,#kcall_list,#btnsearchBox,#bgwin").hide();
            $("#notread").removeClass("selectafter selectbefore");
        }
    });
    
    $(document).find(".li_img_box img").css({'height':$(this).find(".li_content_box").Height()-3,'width':'auto'});
    
    $(".collection_box").css({'margin-top':$(".top_jifen").outerHeight()});
    
    $(".selects p").divselect();

    function getrecordlist(){
        var courseId = $("#courseid").val()||"";
        var keyword = $("#input_search").val()||"";
                    if(courseId == 1){
                        var id = "SliceList=" + 1;
                    }else if(courseId == 2){
                        var id = "QuestionList=" + 2;
                    }else if(courseId == 3){
                        var id = "ExamQuestionList=" + 3;
                    }else if(courseId == 4){
                        var id = "CurriculumList=" + 4;
                    }else if(courseId == 5){
                        var id = "CourseWareList=" + 5;
                    }else if(courseId == 6){
                        var id = "VideoList=" + 6;
                    }

        var url = common.interfaceBase + "GetStudyRecord?IsNew=true&" + id;
        if(keyword){
            var url = common.interfaceBase + "GetStudyRecord?IsNew=true&" + id + "&keyword=" + keyword;
        }
        var method = "get";
        var result = [];
        result =  WAjax(url,method);

        localStorage["recordList"] = JSON.stringify(result);
      /*  result.forEach(function(e){
                if(e.ThumbnailUrl){
                    e.ThumbnailUrl= common.sliceImgBase + e.ThumbnailUrl+"')";
                }else{
                    e.ThumbnailUrl= "url(img/li-img.png)";
                }
            })*/
    


        recordList.CurriculumList = result.CurriculumList;
        recordList.CourseWareList = result.CourseWareList;
        recordList.QuestionList = result.QuestionList;
        recordList.ExerciseList = result.ExerciseList;
        recordList.SliceList = result.SliceList;
        recordList.VideoList = result.VideoList;

    /*for(int i = 0;i<result.CurriculumList.size;i++){
            if(e.ThumbnailUrl){
                    e.ThumbnailUrl= common.sliceImgBase + e.ThumbnailUrl+"')";
                }else{
                    e.ThumbnailUrl= "url(img/li-img.png)";
                }
        }*/

        onChangeList(courseId);

    }
    function onChangeList(id){
    var list = JSON.parse(localStorage["recordList"]);
    if (id == 1){
        recordList.CurriculumList = [];
        recordList.CourseWareList = [];
        recordList.QuestionList = [];
        recordList.ExerciseList = [];
        recordList.SliceList = list.SliceList;
        recordList.VideoList = [];
    }else if(id == 2){
        recordList.CurriculumList = [];
        recordList.CourseWareList = [];
        recordList.QuestionList = list.QuestionList;
        recordList.ExerciseList = [];
        recordList.SliceList = [];
        recordList.VideoList = [];
    }else if(id == 3){
        recordList.CurriculumList = [];
        recordList.CourseWareList = [];
        recordList.QuestionList = [];
        recordList.ExerciseList = list.ExerciseList;
        recordList.SliceList = [];
        recordList.VideoList = [];
    }else if(id == 4){
        recordList.CurriculumList = list.CurriculumList;
        recordList.CourseWareList = [];
        recordList.QuestionList = [];
        recordList.ExerciseList = [];
        recordList.SliceList = [];
        recordList.VideoList = [];
    }else if(id == 5){
        recordList.CurriculumList = [];
        recordList.CourseWareList = list.CourseWareList;
        recordList.QuestionList = [];
        recordList.ExerciseList = [];
        recordList.SliceList = [];
        recordList.VideoList = [];
    }else if(id == 6){
        recordList.CurriculumList = [];
        recordList.CourseWareList = [];
        recordList.QuestionList = [];
        recordList.ExerciseList = [];
        recordList.SliceList = [],
        recordList.VideoList = list.VideoList
    }
}
     $("#btns_search").on("tap",function(){
        getrecordlist();
    })

});

 /*返回*/
    $(".back").on("tap",function(){
        //window.location.href = "course.html";
        common.goToHistoryPage();
    });

</script>
</body>
</html>
